<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API Error format | The REST API cookbook</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="How to format the response body in case of an API error?">
    
    <link rel="preload" href="/cookbook/assets/css/0.styles.c5e61fbd.css" as="style"><link rel="preload" href="/cookbook/assets/js/app.5a8ce820.js" as="script"><link rel="preload" href="/cookbook/assets/js/3.ee39ecec.js" as="script"><link rel="preload" href="/cookbook/assets/js/1.362971f1.js" as="script"><link rel="preload" href="/cookbook/assets/js/12.e9ecba92.js" as="script"><link rel="prefetch" href="/cookbook/assets/js/10.6c3972e3.js"><link rel="prefetch" href="/cookbook/assets/js/11.10ac9f33.js"><link rel="prefetch" href="/cookbook/assets/js/13.b36f1531.js"><link rel="prefetch" href="/cookbook/assets/js/14.4bdfae4d.js"><link rel="prefetch" href="/cookbook/assets/js/4.42a6e734.js"><link rel="prefetch" href="/cookbook/assets/js/5.c606388b.js"><link rel="prefetch" href="/cookbook/assets/js/6.d22eb389.js"><link rel="prefetch" href="/cookbook/assets/js/7.44b4360b.js"><link rel="prefetch" href="/cookbook/assets/js/8.991d042e.js"><link rel="prefetch" href="/cookbook/assets/js/9.30e668a1.js">
    <link rel="stylesheet" href="/cookbook/assets/css/0.styles.c5e61fbd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/cookbook/" class="home-link router-link-active"><!----> <span class="site-name">The REST API cookbook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="api-error-format"><a href="#api-error-format" class="header-anchor">#</a> API Error format</h1> <h2 id="use-case"><a href="#use-case" class="header-anchor">#</a> Use-case</h2> <p>My API returns errors in various cases:</p> <ul><li>the request does not satisfy my business rules</li> <li>a resource does not exist</li> <li>the request is not properly formatted</li> <li>an unexpected error occurred (yes, it happens!)</li> <li>...</li></ul> <p>In case of an error, I already know about <a href="https://httpstatuses.com/" target="_blank" rel="noopener noreferrer">HTTP status codes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (should be in <code>4xx</code> or <code>5xx</code>), but what should I put in the response body?</p> <h2 id="recipe"><a href="#recipe" class="header-anchor">#</a> Recipe</h2> <p><strong>Choose an error format for your API, and stick with it.</strong></p> <p>The error response body should be an object, containing always the same attributes.</p> <p>It should at least contain:</p> <ul><li>an <strong>error code</strong>: a human-readable code, shortly describing the problem, usable by an application to identify the error.
<ul><li>the error code is unique for each error case.</li> <li>a Client (like a frontend) may be able to write a condition on this code, for example to display a specific message to the user.</li> <li>suggested format: upper snake case, with explicit words</li> <li>e.g.: <code>PRODUCT_NOT_FOUND</code>, <code>ORDER_ALREADY_PAID</code>, <code>NO_SEARCH_RESULT</code>...</li></ul></li> <li>an <strong>error message</strong>: a human-readable description, fully describing the problem.
<ul><li>the message may differ from one occurrence to another: it can contain data explaining this specific error, eg: <code>The product #42 is no longer available.</code></li> <li>this message is meant for helping Client developers to debug. In most cases, it should not be displayed as is to an end-user.</li></ul></li></ul> <p>The complete format depends on your API standard (snake or caml case, etc.). Here is a suggestion:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;error_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;PRODUCT_NOT_FOUND&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error_message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;The product #42 is no longer available.&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="internal-server-errors"><a href="#internal-server-errors" class="header-anchor">#</a> Internal Server Errors</h3> <p>Unexpected exceptions should always be caught at the higher level of your application, so that they are transformed to a <a href="https://httpstatuses.com/500" target="_blank" rel="noopener noreferrer">500 API error<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> with a neutral message.</p> <p>For security concerns, always avoid to expose your implementation details in your API responses (stack trace, database errors, etc.).<br>
Use logs instead for debugging the error.</p> <p>Here is a suggestion of a response body for a 500 error:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;error_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UNEXPECTED_ERROR&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error_message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;An unexpected error occurred.&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="documentation"><a href="#documentation" class="header-anchor">#</a> Documentation</h3> <p>The generic error response format should be visible in your API documention (such as Swagger UI), and associated to <code>4xx</code> and <code>5xx</code> status codes.</p> <p>The list of possible error codes returned by an endpoint should be listed along with the endpoint description.</p> <h3 id="about-status-codes"><a href="#about-status-codes" class="header-anchor">#</a> About Status codes</h3> <p>HTTP Status codes and built-in error codes are complementary:</p> <ul><li>the <strong>status code</strong> indicates a <strong>high-level typology of errors</strong>: authentication, resource not found, incorrect request syntax, business rule violation...<br>
This is helpful for the Client to perform a first treatment when no details are needed: 401 -&gt; redirect to login form, 404 -&gt; display the Not Found error page, etc.</li> <li>the <strong>error code</strong> identifies a <strong>specific error case</strong>: it allows the Client to perform fine-grained handling of the error when necessary.</li></ul> <h3 id="don-ts"><a href="#don-ts" class="header-anchor">#</a> Don'ts</h3> <ul><li><strong>don't use HTTP Status Code as error codes</strong>: you will never achieve a one-to-one mapping between error cases and statuses. It does not scale at all: you will be stuck as soon as you will want to make the difference between two cases that belong to the same status.</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;error_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;404&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error_message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;The product #42 does not exist.&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;error_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;404&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error_message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;The basket #1 is no longer available.&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>don't use technical error codes</strong>, such as numeric values or non-explicit codes: your Client will have to go through an unfriendly documentation for understanding the error.
<ul><li>eg: <code>&quot;error_code&quot;: &quot;42&quot;</code>, <code>&quot;error_code&quot;: &quot;NF&quot;</code>...</li> <li>this is also a good practice of separation of concerns: if internal codes are exposed on your API, it means that the API is coupled with your implementation. Refactoring may be more difficult, since your API Clients are now aware of some of your internal details. Technical stuff should not appear on your API!</li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/cookbook/assets/js/app.5a8ce820.js" defer></script><script src="/cookbook/assets/js/3.ee39ecec.js" defer></script><script src="/cookbook/assets/js/1.362971f1.js" defer></script><script src="/cookbook/assets/js/12.e9ecba92.js" defer></script>
  </body>
</html>
