(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{390:function(e,t,a){"use strict";a.r(t);var s=a(42),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"complex-filter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#complex-filter"}},[e._v("#")]),e._v(" Complex filter")]),e._v(" "),a("h2",{attrs:{id:"use-case"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#use-case"}},[e._v("#")]),e._v(" Use-case")]),e._v(" "),a("p",[e._v("On any APIs where there is a need to fetch resources, there is also a need to filter these using search criteria.\nIn most cases, these criteria are present in the url as query params.\nIt can be tempting to shorten the request by using shortens or code to describe your search criterias, ending up with something like:")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("GET https://api.example.com/v1/products?page"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("limit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("5")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("productType")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("type1"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("productType")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("type2"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("productType")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("type3"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("brand")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("brand1"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("brand")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("brand2"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n")])])]),a("p",[e._v("In this case, the request is even less readable, you will need a very strong documentation and you may end up developping dictionnaries to list all those codes.\nAlso, it may exceed the maximum length of the URL (depending on the browser).")]),e._v(" "),a("p",[e._v("And in the case where there are nested parameters, long series of values for one criterion, how can we handle it?")]),e._v(" "),a("p",[e._v("So what can we do about all of this? Let's look at the following recipes.")]),e._v(" "),a("h2",{attrs:{id:"recipe-1-use-a-different-request-method-verb-post"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#recipe-1-use-a-different-request-method-verb-post"}},[e._v("#")]),e._v(" Recipe 1: use a different request method, verb POST")]),e._v(" "),a("p",[e._v("It may seem confusing but keep in mind that an endpoint either may or may not return (GET) or accept (POST/PUT)/... resources.")]),e._v(" "),a("p",[e._v("In "),a("a",{attrs:{href:"http://www.rfcreader.com/#rfc2616_line2483",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 2616"),a("OutboundLink")],1),e._v(", it is defined that with POST, the data sent may not result in the creation of a new resource.")]),e._v(" "),a("p",[e._v("Using the HTTP verb POST, creates an endpoint which accepts a request body that contains the Search Criteria.")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("POST https://api.example.com/v1/products/search HTTP/1.1\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"page"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"limit"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("15")]),e._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"productType"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"type1"')]),e._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"type2"')]),e._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"type3"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"brand"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"brand1"')]),e._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"brand2"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"otherSearchCriteria"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("200")]),e._v(" OK\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),a("p",[e._v("This endpoint will not create any resource but will return the result of the search with the sent criteria.")]),e._v(" "),a("h3",{attrs:{id:"benefits-and-drawbacks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#benefits-and-drawbacks"}},[e._v("#")]),e._v(" Benefits and drawbacks")]),e._v(" "),a("p",[e._v("Benefits:")]),e._v(" "),a("ul",[a("li",[e._v("endpoint is readable because the Search Criteria is structured")]),e._v(" "),a("li",[e._v("handle more complex search criteria, ex: nested parameters, array")]),e._v(" "),a("li",[e._v("will never reach the maximum length of the URL")])]),e._v(" "),a("p",[e._v("Drawbacks:")]),e._v(" "),a("ul",[a("li",[e._v("because it's not common to use a POST like this, consumers need to know all the specifications in order to use this endpoint such as the body of Search Criteria")]),e._v(" "),a("li",[e._v("cannot share a link to make the same search")]),e._v(" "),a("li",[e._v("not recommended if the request body can not be easily retrieved (e.g. from a log monitor)\n"),a("ul",[a("li",[e._v("it will be hard to reproduce the request")])])]),e._v(" "),a("li",[e._v("responses to POST are not target of caching operations, HTTP caches are limited to caching responses to GET\n"),a("ul",[a("li",[e._v("it may be possible to cache responses to POST, but it will be difficult")])])])]),e._v(" "),a("h2",{attrs:{id:"recipe-2-put-an-object-into-an-url-parameter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#recipe-2-put-an-object-into-an-url-parameter"}},[e._v("#")]),e._v(" Recipe 2: put an object into an URL parameter")]),e._v(" "),a("p",[e._v("Where is this recipe used? In Grafana, Kibana, Amazon (e-commerce)...")]),e._v(" "),a("p",[e._v("Using the HTTP verb GET, creates an endpoint which accepts an object (JSON, XML,...) in the url parameter.")]),e._v(" "),a("p",[e._v("At first, it will look like this because the object will be encoded.")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("GET https://api.example.com/v1/products?searchCriteria"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("%7B%22page%22%3A1%2C%22limit%22%3A15%2C%22productType%22%3A%5B%22type1%22%2C%22type2%22%2C%22type3%22%5D%2C%22brand%22%3A%5B%22brand1%22%2C%22brand2%22%5D%2C%22otherSearchCriteria%22%3A"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".%7D HTTP/1.1\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("200")]),e._v(" OK\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),a("p",[e._v("But when decoded, it will look like this.")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("GET https://api.example.com/v1/products?searchCriteria"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"page"')]),e._v(":1,"),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"limit"')]),e._v(":15,"),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"productType"')]),e._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"type1"')]),e._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"type2"')]),e._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"type3"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"brand"')]),e._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"brand1"')]),e._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"brand2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"otherSearchCriteria"')]),e._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" HTTP/1.1\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("200")]),e._v(" OK\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),a("p",[e._v("When receiving the request, the API must decode the url parameters to interpret it.")]),e._v(" "),a("h3",{attrs:{id:"benefits-and-drawbacks-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#benefits-and-drawbacks-2"}},[e._v("#")]),e._v(" Benefits and drawbacks")]),e._v(" "),a("p",[e._v("Benefits:")]),e._v(" "),a("ul",[a("li",[e._v("the parameters are structured in an object")]),e._v(" "),a("li",[e._v("handle more complex search criteria, ex: nested parameters, array")]),e._v(" "),a("li",[e._v("reduces the number of occurrences of query params")]),e._v(" "),a("li",[e._v("responses to GET can be cached by a browser, proxy, cdn, gateway...")])]),e._v(" "),a("p",[e._v("Drawbacks:")]),e._v(" "),a("ul",[a("li",[e._v("url is not readable")]),e._v(" "),a("li",[e._v("there is a need to decode the url parameters")]),e._v(" "),a("li",[e._v("it should not be abused, it should be used for the most complex endpoints\n"),a("ul",[a("li",[e._v("in case this method is used, there may be a need to reconsider the design\n(the reason is trying to do too many things with this endpoint)")])])])]),e._v(" "),a("h2",{attrs:{id:"recipe-3-use-of-delimiters-within-a-query-param"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#recipe-3-use-of-delimiters-within-a-query-param"}},[e._v("#")]),e._v(" Recipe 3: use of delimiters within a query param")]),e._v(" "),a("p",[e._v("Instead of having multiple query params for one parameter, delimiters can be used within a single query param.")]),e._v(" "),a("p",[e._v("Using the example in the use-case with a delimiter like "),a("code",[e._v(",")]),e._v(", it will look like:")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("GET https://api.example.com/v1/products?page"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("limit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("5")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("productType")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("type1,type2,type3"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("brand")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("brand1,brand2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\n")])])]),a("p",[e._v("But it will only work on string query params.")]),e._v(" "),a("p",[e._v("Plus in the API side, there will be a need to parse the query params "),a("code",[e._v("productType")]),e._v(" & "),a("code",[e._v("brand")]),e._v(" by the delimiter.")]),e._v(" "),a("h3",{attrs:{id:"benefits-and-drawbacks-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#benefits-and-drawbacks-3"}},[e._v("#")]),e._v(" Benefits and drawbacks")]),e._v(" "),a("p",[e._v("Benefits:")]),e._v(" "),a("ul",[a("li",[e._v("reduces the number of occurrences of query params")]),e._v(" "),a("li",[e._v("enhances readability")])]),e._v(" "),a("p",[e._v("Drawbacks:")]),e._v(" "),a("ul",[a("li",[e._v("consumers need to know the specifications")]),e._v(" "),a("li",[e._v("limited use on string query params")]),e._v(" "),a("li",[e._v("need to choose a delimiter that will not hinder the readability\n"),a("ul",[a("li",[a("code",[e._v(",")]),e._v(" is OK")]),e._v(" "),a("li",[a("code",[e._v(";")]),e._v(" "),a("code",[e._v("|")]),e._v(" "),a("code",[e._v("&")]),e._v(" are reserved characters and can not be used")])])])])])}),[],!1,null,null,null);t.default=r.exports}}]);