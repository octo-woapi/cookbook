(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{397:function(e,t,a){"use strict";a.r(t);var s=a(42),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"partial-update-of-a-resource"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#partial-update-of-a-resource"}},[e._v("#")]),e._v(" Partial update of a resource")]),e._v(" "),a("h2",{attrs:{id:"use-case"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#use-case"}},[e._v("#")]),e._v(" Use-case")]),e._v(" "),a("p",[e._v("My API has a "),a("code",[e._v("/users")]),e._v(" resource, representing a User, and containing its personal information: name, email, address...")]),e._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("42")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"first_name"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Tom"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"last_name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Smith"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"email"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"tom.smith@example.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"phone"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"home"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0123456789"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"mobile"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"9876543210"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"address"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"street"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"50, avenue des Champs-Elysées"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"zip_code"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"75008"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[e._v('"city"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"PARIS"')]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("p",[e._v("The user modifies his profile to update only his address.")]),e._v(" "),a("p",[e._v("I could perform a complete update, and send the whole resource back with a "),a("code",[e._v("PUT")]),e._v(" request. But the payload may be huge, with a lot of useless fields since I just want to update the address.")]),e._v(" "),a("p",[e._v("How can I perform a partial update, sending only the new address?")]),e._v(" "),a("h2",{attrs:{id:"recipe"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#recipe"}},[e._v("#")]),e._v(" Recipe")]),e._v(" "),a("p",[e._v("Partial update can be performed with a "),a("code",[e._v("PUT")]),e._v(" request on a sub-resource. It is indeed a complete update, but of a fraction of the initial resource.")]),e._v(" "),a("p",[e._v("This sub-resource should be meaningful on a business level.")]),e._v(" "),a("p",[e._v("In our example, it would be "),a("code",[e._v("users/:id/address")]),e._v("."),a("br"),e._v("\nNote that this sub-resource can be in the singular, since it is a single resource and not a collection.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('PUT https://api.example.com/v1/users/42/address HTTP/1.1\n{\n    "street": "34, avenue de l\'Opéra",\n    "zip_code": "75002",\n    "city": "PARIS"\n}\n\n< 200 OK\n')])])]),a("p",[e._v("This design also works for updating just one field:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('PUT https://api.example.com/v1/users/42/email HTTP/1.1\n"my_new_email@example.com"\n\n< 200 OK\n')])])]),a("p",[a("strong",[e._v("Benefits:")])]),e._v(" "),a("ul",[a("li",[e._v("your API "),a("strong",[e._v("expresses exactly what you can update")]),e._v(" on a business point of view:"),a("br"),e._v("\nUpdating the address or the email may be performed on different moments of the User lifecycle, with specific business rules. Some other fields of the User may not be open to modification. Having different endpoints for each of these business operations clearly indicates that they are separate, and does not let the API Client decide what field he wants to update or not.")]),e._v(" "),a("li",[e._v("you avoid the drawbacks of "),a("code",[e._v("PATCH")]),e._v(" (see below)")])]),e._v(" "),a("p",[a("strong",[e._v("Drawbacks:")])]),e._v(" "),a("ul",[a("li",[e._v("this is not suited if you need flexibility on the fields you want to update")]),e._v(" "),a("li",[e._v("obviously, you end up with more endpoints on your API (but is that really a problem?)")])]),e._v(" "),a("h3",{attrs:{id:"why-not-patch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#why-not-patch"}},[e._v("#")]),e._v(" Why not PATCH?")]),e._v(" "),a("p",[e._v("In the REST standard, "),a("code",[e._v("PATCH")]),e._v(" is usually described as the HTTP verb to use in case of a partial update.")]),e._v(" "),a("p",[e._v("Nevertheless, we discourage from using "),a("code",[e._v("PATCH")]),e._v(":"),a("br"),e._v("\nthe format of the payload indicating the changes to apply on the resource is not specified in "),a("a",{attrs:{href:"https://datatracker.ietf.org/doc/html/rfc5789",target:"_blank",rel:"noopener noreferrer"}},[e._v("the HTTP RFC"),a("OutboundLink")],1),e._v(".\nIt means that the Client will have to read your documentation to understand how the payload should be formatted to update only the address.")]),e._v(" "),a("p",[e._v("To compensate this grey area, several standards have been proposed, such as:")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://datatracker.ietf.org/doc/html/rfc6902",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON Patch"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/digibib/ls.ext/wiki/JSON-LD-PATCH",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON-LD"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://datatracker.ietf.org/doc/html/rfc7396",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON Merge Patch"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("But none of them are integrated in the HTTP spec: you will have to chose one and let the Client know how to format the request.")]),e._v(" "),a("p",[a("code",[e._v("PATCH")]),e._v(" can also leads to tricky business cases, that will not be obvious when looking at your API: is a missing field a suppression? what if some fields have to be updated altogether?")]),e._v(" "),a("p",[e._v("On the other hand, "),a("code",[e._v("PUT")]),e._v(" has many advantages:")]),e._v(" "),a("ul",[a("li",[e._v("its format is standard and predictable, since you have to send the complete resource")]),e._v(" "),a("li",[e._v("unlike "),a("code",[e._v("PATCH")]),e._v(", it is safe and idempotent")])]),e._v(" "),a("p",[a("strong",[e._v("Then, should I never use "),a("code",[e._v("PATCH")]),e._v("?")]),a("br"),e._v("\nIf you want a complete flexibility on the fields that will be updated, but you don't want to perform a complete update with "),a("code",[e._v("PUT")]),e._v(" because the payload will be too big, "),a("code",[e._v("PATCH")]),e._v(" is the only way to go."),a("br"),e._v("\nBut in this case, it may reveal that the resource is too big, or that its business meaning is unclear, and we encourage you to reconsider its granularity.")]),e._v(" "),a("h2",{attrs:{id:"resources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#resources"}},[e._v("#")]),e._v(" Resources")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.octo.com/should-i-put-or-should-i-patch/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Should I PUT or should I PATCH?"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=r.exports}}]);