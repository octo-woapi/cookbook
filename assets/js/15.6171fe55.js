(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{393:function(e,t,s){"use strict";s.r(t);var r=s(42),a=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"api-error-format"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#api-error-format"}},[e._v("#")]),e._v(" API Error format")]),e._v(" "),s("h2",{attrs:{id:"use-case"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#use-case"}},[e._v("#")]),e._v(" Use-case")]),e._v(" "),s("p",[e._v("My API returns errors in various cases:")]),e._v(" "),s("ul",[s("li",[e._v("the request does not satisfy my business rules")]),e._v(" "),s("li",[e._v("a resource does not exist")]),e._v(" "),s("li",[e._v("the request is not properly formatted")]),e._v(" "),s("li",[e._v("an unexpected error occurred (yes, it happens!)")]),e._v(" "),s("li",[e._v("...")])]),e._v(" "),s("p",[e._v("In case of an error, I already know about "),s("a",{attrs:{href:"https://httpstatuses.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("HTTP status codes"),s("OutboundLink")],1),e._v(" (should be in "),s("code",[e._v("4xx")]),e._v(" or "),s("code",[e._v("5xx")]),e._v("), but what should I put in the response body?")]),e._v(" "),s("h2",{attrs:{id:"recipe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#recipe"}},[e._v("#")]),e._v(" Recipe")]),e._v(" "),s("p",[s("strong",[e._v("Choose an error format for your API, and stick with it.")])]),e._v(" "),s("p",[e._v("The error response body should be an object, containing always the same attributes.")]),e._v(" "),s("p",[e._v("It should at least contain:")]),e._v(" "),s("ul",[s("li",[e._v("an "),s("strong",[e._v("error code")]),e._v(": a human-readable code, shortly describing the problem, usable by an application to identify the error.\n"),s("ul",[s("li",[e._v("the error code is unique for each error case.")]),e._v(" "),s("li",[e._v("a Client (like a frontend) may be able to write a condition on this code, for example to display a specific message to the user.")]),e._v(" "),s("li",[e._v("suggested format: upper snake case, with explicit words")]),e._v(" "),s("li",[e._v("e.g.: "),s("code",[e._v("PRODUCT_NOT_FOUND")]),e._v(", "),s("code",[e._v("ORDER_ALREADY_PAID")]),e._v(", "),s("code",[e._v("NO_SEARCH_RESULT")]),e._v("...")])])]),e._v(" "),s("li",[e._v("an "),s("strong",[e._v("error message")]),e._v(": a human-readable description, fully describing the problem.\n"),s("ul",[s("li",[e._v("the message may differ from one occurrence to another: it can contain data explaining this specific error, eg: "),s("code",[e._v("The product #42 is no longer available.")])]),e._v(" "),s("li",[e._v("this message is meant for helping Client developers to debug. In most cases, it should not be displayed as is to an end-user.")])])])]),e._v(" "),s("p",[e._v("The complete format depends on your API standard (snake or caml case, etc.). Here is a suggestion:")]),e._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"error_code"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"PRODUCT_NOT_FOUND"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"error_message"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"The product #42 is no longer available."')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("h3",{attrs:{id:"internal-server-errors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#internal-server-errors"}},[e._v("#")]),e._v(" Internal Server Errors")]),e._v(" "),s("p",[e._v("Unexpected exceptions should always be caught at the higher level of your application, so that they are transformed to a "),s("a",{attrs:{href:"https://httpstatuses.com/500",target:"_blank",rel:"noopener noreferrer"}},[e._v("500 API error"),s("OutboundLink")],1),e._v(" with a neutral message.")]),e._v(" "),s("p",[e._v("For security concerns, always avoid to expose your implementation details in your API responses (stack trace, database errors, etc.)."),s("br"),e._v("\nUse logs instead for debugging the error.")]),e._v(" "),s("p",[e._v("Here is a suggestion of a response body for a 500 error:")]),e._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"error_code"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"UNEXPECTED_ERROR"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"error_message"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"An unexpected error occurred."')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("h3",{attrs:{id:"documentation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#documentation"}},[e._v("#")]),e._v(" Documentation")]),e._v(" "),s("p",[e._v("The generic error response format should be visible in your API documention (such as Swagger UI), and associated to "),s("code",[e._v("4xx")]),e._v(" and "),s("code",[e._v("5xx")]),e._v(" status codes.")]),e._v(" "),s("p",[e._v("The list of possible error codes returned by an endpoint should be listed along with the endpoint description.")]),e._v(" "),s("h3",{attrs:{id:"about-status-codes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#about-status-codes"}},[e._v("#")]),e._v(" About Status codes")]),e._v(" "),s("p",[e._v("HTTP Status codes and built-in error codes are complementary:")]),e._v(" "),s("ul",[s("li",[e._v("the "),s("strong",[e._v("status code")]),e._v(" indicates a "),s("strong",[e._v("high-level typology of errors")]),e._v(": authentication, resource not found, incorrect request syntax, business rule violation..."),s("br"),e._v("\nThis is helpful for the Client to perform a first treatment when no details are needed: 401 -> redirect to login form, 404 -> display the Not Found error page, etc.")]),e._v(" "),s("li",[e._v("the "),s("strong",[e._v("error code")]),e._v(" identifies a "),s("strong",[e._v("specific error case")]),e._v(": it allows the Client to perform fine-grained handling of the error when necessary.")])]),e._v(" "),s("h3",{attrs:{id:"don-ts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#don-ts"}},[e._v("#")]),e._v(" Don'ts")]),e._v(" "),s("ul",[s("li",[s("strong",[e._v("don't use HTTP Status Code as error codes")]),e._v(": you will never achieve a one-to-one mapping between error cases and statuses. It does not scale at all: you will be stuck as soon as you will want to make the difference between two cases that belong to the same status.")])]),e._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"error_code"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"404"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"error_message"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"The product #42 does not exist."')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"error_code"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"404"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"error_message"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"The basket #1 is no longer available."')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("ul",[s("li",[s("strong",[e._v("don't use technical error codes")]),e._v(", such as numeric values or non-explicit codes: your Client will have to go through an unfriendly documentation for understanding the error.\n"),s("ul",[s("li",[e._v("eg: "),s("code",[e._v('"error_code": "42"')]),e._v(", "),s("code",[e._v('"error_code": "NF"')]),e._v("...")]),e._v(" "),s("li",[e._v("this is also a good practice of separation of concerns: if internal codes are exposed on your API, it means that the API is coupled with your implementation. Refactoring may be more difficult, since your API Clients are now aware of some of your internal details. Technical stuff should not appear on your API!")])])])])])}),[],!1,null,null,null);t.default=a.exports}}]);