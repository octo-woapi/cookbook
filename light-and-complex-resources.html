<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Light and complex resources | The REST API cookbook</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="I need a light version and a complete version of the same resource">
    
    <link rel="preload" href="/cookbook/assets/css/0.styles.61efb392.css" as="style"><link rel="preload" href="/cookbook/assets/js/app.6831e30b.js" as="script"><link rel="preload" href="/cookbook/assets/js/3.9f6d8892.js" as="script"><link rel="preload" href="/cookbook/assets/js/1.58ef23db.js" as="script"><link rel="preload" href="/cookbook/assets/js/14.0b373add.js" as="script"><link rel="prefetch" href="/cookbook/assets/js/10.349c0212.js"><link rel="prefetch" href="/cookbook/assets/js/11.c68e2c6f.js"><link rel="prefetch" href="/cookbook/assets/js/12.ed580dcf.js"><link rel="prefetch" href="/cookbook/assets/js/13.e04b106e.js"><link rel="prefetch" href="/cookbook/assets/js/15.34b23616.js"><link rel="prefetch" href="/cookbook/assets/js/4.f8125ee1.js"><link rel="prefetch" href="/cookbook/assets/js/5.3f04cbe9.js"><link rel="prefetch" href="/cookbook/assets/js/6.b29b864a.js"><link rel="prefetch" href="/cookbook/assets/js/7.6dafa1e9.js"><link rel="prefetch" href="/cookbook/assets/js/8.1b37a035.js"><link rel="prefetch" href="/cookbook/assets/js/9.c76afe15.js">
    <link rel="stylesheet" href="/cookbook/assets/css/0.styles.61efb392.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/cookbook/" class="home-link router-link-active"><!----> <span class="site-name">The REST API cookbook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="light-and-complex-resources"><a href="#light-and-complex-resources" class="header-anchor">#</a> Light and complex resources</h1> <h2 id="use-case"><a href="#use-case" class="header-anchor">#</a> Use-case</h2> <p>On my e-commerce API, I have an entity called Product, representing a product sold on the API.<br>
A Product can have many attributes, but the API Clients usually don't need all of them at the same time.</p> <p>A single resource <code>GET /products/:id</code> would be too big for most usages, but all the attributes are needed at a step of my workflow.</p> <p>How can I build an API that meets all these requirements?</p> <h2 id="recipe-1-expose-several-resources-with-real-business-meaning"><a href="#recipe-1-expose-several-resources-with-real-business-meaning" class="header-anchor">#</a> Recipe 1: expose several resources with real business meaning</h2> <p>If your ressource is too big, it is probably because your endpoint tries to cover multiple business cases: display a list of products as a search result, details of a product, technical info, prices, stocks, etc.\</p> <p>A good solution would be to split your resource in several resources and sub-resources each related to a business case, that will be used in different business contexts:</p> <ul><li><code>GET /products/:id</code> would contain the minimum product information, necessary for a simple display, such as labels, descriptions or a main image.</li> <li><code>GET /products/:id/technical_info</code>, <code>GET /products/:id/ratings</code>, <code>GET /products/:id/images</code>...</li> <li>this works especially if some information requires another parameter: <code>GET /products/:id/stocks?location_id=...</code> returns the stock at a specific location.</li></ul> <p>If you have different types of products (like books, clothes and computers on the same e-commerce API), they probably don't share the same characteristics. It would be interesting to build specific resources for your API to expose the real business case:</p> <ul><li><code>GET /products/:id</code> with shared characteristics (labels, etc.) and links to following specific resources</li> <li><code>GET /books/:id</code> only for books, with their specific attributes: author, publisher, translator, back cover...</li> <li><code>GET /computers/:id</code> with screen size, RAM, CPU...</li></ul> <p>In a nutshell: <strong>split your resource, but in a business-relevant way.</strong></p> <p>Benefits:</p> <ul><li>your API is affordable and really reflects your business</li> <li>no more huge single resource that forces the Client to load many useless information, impacting performances</li></ul> <p>Drawbacks:</p> <ul><li>if a Client needs multiple information at once, it will have to do multiple calls</li></ul> <h2 id="recipe-2-on-demand-fields-on-a-single-resource"><a href="#recipe-2-on-demand-fields-on-a-single-resource" class="header-anchor">#</a> Recipe 2: on-demand fields on a single resource</h2> <p>If the business split is not possible, for example if it does not cover the multiple use cases of yours Clients, you can still keep a single resource.</p> <p>In this case, you can add a <code>?fields=...</code> query string parameter, that will allow the Client to chose which field(s) are needed depending on its own context:</p> <p>The full product without filtering:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>GET https://api.example.com/v1/products/42 HTTP/1.1
<span class="token operator">&lt;</span> <span class="token number">200</span> OK
<span class="token operator">&lt;</span> <span class="token punctuation">{</span>
<span class="token operator">&lt;</span>     <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">42</span>,
<span class="token operator">&lt;</span>     <span class="token string">&quot;title&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;My fancy product!&quot;</span>,
<span class="token operator">&lt;</span>     <span class="token string">&quot;description&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;The best of all products&quot;</span>,
<span class="token operator">&lt;</span>     <span class="token string">&quot;images&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;//some.url&quot;</span><span class="token punctuation">]</span>,
<span class="token operator">&lt;</span>     <span class="token string">&quot;height&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;120&quot;</span>,
<span class="token operator">&lt;</span>     <span class="token string">&quot;width&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;100&quot;</span>,
<span class="token operator">&lt;</span>     <span class="token string">&quot;weight&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;10&quot;</span>,
<span class="token operator">&lt;</span>     <span class="token string">&quot;author&quot;</span><span class="token builtin class-name">:</span> null,
<span class="token operator">&lt;</span>     <span class="token punctuation">..</span>.
<span class="token operator">&lt;</span> <span class="token punctuation">}</span>
</code></pre></div><p>The same with the fields filter:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>GET https://api.example.com/v1/products/42?fields<span class="token operator">=</span>title,description HTTP/1.1
<span class="token operator">&lt;</span> <span class="token number">200</span> OK
<span class="token operator">&lt;</span> <span class="token punctuation">{</span>
<span class="token operator">&lt;</span>     <span class="token string">&quot;title&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;My fancy product!&quot;</span>,
<span class="token operator">&lt;</span>     <span class="token string">&quot;description&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;The best of all products&quot;</span>
<span class="token operator">&lt;</span> <span class="token punctuation">}</span>
</code></pre></div><p>Benefits:</p> <ul><li>Simple to implement and to understand for the Client</li> <li>Can be combined with the <strong>Recipe 1</strong> for filtering fields on any resource</li> <li>The size of the response will be lighter.</li> <li>It does not need Clients refactoring. Legacy client will still continue to work as before.</li></ul> <p>Drawbacks:</p> <ul><li>Depending on your backend implementation, you may have to load the full product anyway and just filter in the response layer.</li> <li>If you have cache on your resource, it will decrease your hit ratio because of the multiple combination of parameters.</li> <li>Calls without any filter may cause performances issues because of the size of the response, but the size won't be higher than without implemeting this solution</li> <li>You do not solve the real issue which is the size of the ressource, and as you don't take the opportunity to solve it, it will probably continue to grow. You will end by having a divergence between your ressources and your business.</li></ul> <h2 id="do-not"><a href="#do-not" class="header-anchor">#</a> Do not</h2> <p>It is sometimes tempting to expose resources like <code>/light_product/:id</code>, <code>/medium_product/:id</code>, <code>/complete_product/:id</code>...</p> <p>The problem with such a design is that you will never know for sure in which resource a field belongs, because of the totally arbitrary repartition of fields. The split between what is in <em>light</em> and <em>medium</em> will probably be driven by your main client (generally your front-end), for a specific and short-sighted need.<br>
This will necessitate a great deal of cognitive load and documentation analysis to check which resource holds the required information. What if a Client needs a field in <em>light</em> and one in <em>medium</em>?\</p> <p>Finally, this solution does not really solve your scalability problems: you will probably end with 2 or 3 splits, and the <em>light</em> resource will be enriched, making it grow to not be lighter anymore.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/cookbook/assets/js/app.6831e30b.js" defer></script><script src="/cookbook/assets/js/3.9f6d8892.js" defer></script><script src="/cookbook/assets/js/1.58ef23db.js" defer></script><script src="/cookbook/assets/js/14.0b373add.js" defer></script>
  </body>
</html>
